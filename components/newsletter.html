<section class="newsletter" aria-labelledby="newsletter-title">
    <div class="container">
        <div class="newsletter__content">
            <h2 id="newsletter-title" class="newsletter__title">Haberdar Olun</h2>
            <p class="newsletter__description">
                Yeni ürünler, teknolojik gelişmeler ve özel fırsatlardan haberdar olun.
            </p>
            
            <form class="newsletter__form" id="newsletter-form" novalidate>
                <div class="newsletter__input-wrapper">
                    <label for="newsletter-email" class="visually-hidden">E-posta Adresi</label>
                    <input 
                        type="email" 
                        id="newsletter-email" 
                        name="email"
                        class="newsletter__input" 
                        placeholder="E-posta adresiniz"
                        aria-describedby="newsletter-error"
                        required
                        pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$"
                        autocomplete="email"
                    >
                    <button type="submit" class="newsletter__button">
                        <span class="btn-text">Abone Ol</span>
                        <svg class="btn-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M5 12h14m-7-7l7 7-7 7"/>
                        </svg>
                        <span class="spinner" aria-hidden="true"></span>
                    </button>
                </div>
                <span id="newsletter-error" class="newsletter__error" role="alert" aria-live="polite"></span>
                <div class="newsletter__success" role="status" aria-live="polite">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                        <polyline points="22 4 12 14.01 9 11.01"/>
                    </svg>
                    <span>Teşekkürler! Başarıyla abone oldunuz.</span>
                </div>
            </form>
            
            <p class="newsletter__privacy">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                    <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                </svg>
                Gizliliğiniz bizim için önemli. E-postanız güvende.
            </p>
        </div>
    </div>
</section>

<style>
.newsletter {
    background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-accent) 100%);
    padding: var(--spacing-20) 0;
    position: relative;
    overflow: hidden;
}

.newsletter::before {
    content: '';
    position: absolute;
    top: -50%;
    right: -10%;
    width: 40%;
    height: 200%;
    background: rgba(255, 255, 255, 0.05);
    transform: rotate(-15deg);
}

.newsletter__content {
    max-width: 600px;
    margin: 0 auto;
    text-align: center;
    position: relative;
    z-index: 1;
}

.newsletter__title {
    color: var(--color-white);
    font-size: var(--font-size-5xl);
    font-weight: var(--font-weight-bold);
    margin-bottom: var(--spacing-4);
}

.newsletter__description {
    color: rgba(255, 255, 255, 0.9);
    font-size: var(--font-size-lg);
    margin-bottom: var(--spacing-8);
}

.newsletter__form {
    margin-bottom: var(--spacing-4);
}

.newsletter__input-wrapper {
    display: flex;
    gap: var(--spacing-2);
    margin-bottom: var(--spacing-2);
}

.newsletter__input {
    flex: 1;
    padding: var(--spacing-4);
    border: 2px solid rgba(255, 255, 255, 0.2);
    border-radius: var(--border-radius-lg);
    background: rgba(255, 255, 255, 0.95);
    font-size: var(--font-size-base);
    transition: all 0.3s ease;
}

.newsletter__input:focus {
    outline: none;
    border-color: var(--color-white);
    background: var(--color-white);
    box-shadow: 0 0 0 4px rgba(255, 255, 255, 0.2);
}

.newsletter__input.error {
    border-color: #ff4444;
    animation: shake 0.3s ease;
}

@keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-8px); }
    75% { transform: translateX(8px); }
}

.newsletter__button {
    padding: var(--spacing-4) var(--spacing-8);
    background: var(--color-white);
    color: var(--color-primary);
    border: none;
    border-radius: var(--border-radius-lg);
    font-weight: var(--font-weight-semibold);
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: var(--spacing-2);
    transition: all 0.3s ease;
    white-space: nowrap;
}

.newsletter__button:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
}

.newsletter__button.loading {
    pointer-events: none;
}

.newsletter__button.loading .btn-text,
.newsletter__button.loading .btn-icon {
    opacity: 0;
}

.newsletter__button .spinner {
    display: none;
    width: 20px;
    height: 20px;
    border: 2px solid var(--color-primary);
    border-top-color: transparent;
    border-radius: 50%;
    animation: spin 0.6s linear infinite;
}

.newsletter__button.loading .spinner {
    display: block;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

.newsletter__error {
    display: none;
    color: #ffcccc;
    font-size: var(--font-size-sm);
    text-align: left;
    padding: var(--spacing-2) var(--spacing-4);
    background: rgba(255, 68, 68, 0.2);
    border-radius: var(--border-radius-base);
}

.newsletter__input.error ~ .newsletter__error {
    display: block;
}

.newsletter__success {
    display: none;
    align-items: center;
    gap: var(--spacing-2);
    color: var(--color-white);
    font-size: var(--font-size-lg);
    padding: var(--spacing-4);
    background: rgba(255, 255, 255, 0.1);
    border-radius: var(--border-radius-lg);
    animation: slideDown 0.3s ease;
}

.newsletter__success.show {
    display: flex;
}

@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.newsletter__privacy {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-2);
    color: rgba(255, 255, 255, 0.8);
    font-size: var(--font-size-sm);
}

@media (max-width: 768px) {
    .newsletter__input-wrapper {
        flex-direction: column;
    }
    
    .newsletter__button {
        width: 100%;
        justify-content: center;
    }
}
</style>

<script>
(function() {
    'use strict';

    const form = document.getElementById('newsletter-form');
    const emailInput = document.getElementById('newsletter-email');
    const button = form?.querySelector('.newsletter__button');
    const errorSpan = document.getElementById('newsletter-error');
    const successMessage = form?.querySelector('.newsletter__success');

    if (!form || !emailInput) return;

    // Real-time validation
    emailInput.addEventListener('input', () => {
        emailInput.classList.remove('error');
        errorSpan.textContent = '';
        
        // Show visual feedback for valid email
        if (emailInput.validity.valid) {
            emailInput.style.borderColor = 'rgba(76, 175, 80, 0.5)';
        } else {
            emailInput.style.borderColor = '';
        }
    });

    // Form submission
    form.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const email = emailInput.value.trim();
        
        // Clear previous errors
        emailInput.classList.remove('error');
        errorSpan.textContent = '';
        
        // Validation
        if (!email) {
            showError('Lütfen e-posta adresinizi girin');
            return;
        }
        
        if (!emailInput.validity.valid) {
            showError('Lütfen geçerli bir e-posta adresi girin (örn: isim@domain.com)');
            return;
        }
        
        // Show loading state
        button.classList.add('loading');
        button.disabled = true;
        
        try {
            // API çağrısı simülasyonu
            await new Promise(resolve => setTimeout(resolve, 1500));
            
            // Gerçek üretimde API çağrısı:
            // const response = await fetch('/api/newsletter/subscribe', {
            //     method: 'POST',
            //     headers: { 'Content-Type': 'application/json' },
            //     body: JSON.stringify({ email })
            // });
            // const data = await response.json();
            // if (!response.ok) throw new Error(data.message);
            
            // Success
            form.querySelector('.newsletter__input-wrapper').style.display = 'none';
            successMessage.classList.add('show');
            
            // Reset after 5 seconds
            setTimeout(() => {
                form.reset();
                form.querySelector('.newsletter__input-wrapper').style.display = 'flex';
                successMessage.classList.remove('show');
                emailInput.style.borderColor = '';
            }, 5000);
            
        } catch (error) {
            showError('Bir hata oluştu. Lütfen daha sonra tekrar deneyin.');
        } finally {
            button.classList.remove('loading');
            button.disabled = false;
        }
    });
    
    function showError(message) {
        emailInput.classList.add('error');
        errorSpan.textContent = message;
        emailInput.focus();
    }
})();
</script>